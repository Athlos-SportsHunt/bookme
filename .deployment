[config]
SCM_DO_BUILD_DURING_DEPLOYMENT=true
PYTHON_VERSION=3.12

[command]
echo "🛠️ Setting up environment..."

# Use system Python rather than virtual environment
PYTHON_PATH=$(which python3)

echo "📦 Installing UV package manager..."
$PYTHON_PATH -m pip install --upgrade pip
$PYTHON_PATH -m pip install uv

echo "📦 Installing dependencies with UV..."
# Use UV to install dependencies but specify system Python
uv pip install -r requirements.txt --system

echo "🚀 Running migrations & collectstatic with UV..."
uv run python manage.py migrate --noinput
uv run python manage.py collectstatic --noinput

echo "🔥 Starting Gunicorn with UV..."
uv run gunicorn bookme.wsgi_prod:application --bind=0.0.0.0:8000 --timeout 600