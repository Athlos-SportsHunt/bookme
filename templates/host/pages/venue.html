{% extends 'host/base.html' %}
{% load static%}

{% block title %}Venue Details - {{ venue.name }}{% endblock %}

{% block imports_block %}
<link rel="stylesheet" href="{% static 'css/host/pages/venue.css'%}">
{% endblock imports_block %}

{% block content %}
<div class="container">
    <h1>Venue: {{ venue.name }}</h1>

    <div class="location-info">
        <span class="location-label">Location:</span>
        <span class="location-value">{{ venue.location }}</span>
    </div>

    <a href="{% url 'host:dashboard' %}" class="back-link">← Back to Dashboard</a>

    <div class="turfs-section">
        <h2>Turfs in this Venue</h2>
        <ul class="turf-list">
            {% for turf in turfs %}
                <li class="turf-item">
                    <a href="{% url 'host:turf' venue.id turf.id %}">
                        <span class="turf-name">{{ turf.name }}</span>
                        <span class="turf-price">₹{{ turf.price_per_hr }}</span>
                    </a>
                </li>
            {% empty %}
                <li class="turf-item">No turfs available for this venue.</li>
            {% endfor %}
        </ul>
        <a href="{% url 'host:create_turf' venue.id %}">
            <button class="create-turf-btn">Create Turf</button>
        </a>
    </div>
    <button class="delete-venue-btn" type="button" data-venue-id="{{ venue.id }}">Delete Venue</button>

</div>
{% endblock content %}

{% block js_imports %}
<script>
document.addEventListener("DOMContentLoaded", function() {
    const deleteButton = document.querySelector(".delete-venue-btn");

    deleteButton.addEventListener("click", async function() {
        const confirmDelete = confirm("Are you sure you want to delete this venue?");
        if (confirmDelete) {
            const venueId = deleteButton.getAttribute("data-venue-id"); // Get from data attribute

            const response = await fetch('{% url "api:delete_venue" venue.id %}', {   
                method: "DELETE",
                headers: {
                    "X-CSRFToken": "{{ csrf_token }}",
                    "Content-Type": "application/json"
                }
            });

            if (response.ok) {
                window.location.href = "{% url 'host:dashboard' %}";
            } else {
                alert("Failed to delete venue. Please try again.");
            }
        }
    });
});
</script>
{% endblock js_imports %}

